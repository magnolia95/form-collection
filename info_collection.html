<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>媒体记者信息收集</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, select, textarea { width: 100%; padding: 8px; box-sizing: border-box; border: 1px solid #ddd; border-radius: 4px; }
        button { background-color: #4CAF50; color: white; padding: 10px 15px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; }
        button:hover { background-color: #45a049; }
        button:disabled { background-color: #cccccc; }
        .success-message { display: none; background-color: #dff0d8; color: #3c763d; padding: 15px; margin-top: 20px; border-radius: 4px; }
        .language-selector { text-align: right; margin-bottom: 20px; }
        h1 { color: #333; border-bottom: 2px solid #4CAF50; padding-bottom: 10px; }
    </style>
</head>
<body>
    <div class="language-selector">
        <button onclick="changeLanguage('cn')" id="cn-btn">中文</button>
        <button onclick="changeLanguage('en')" id="en-btn">English</button>
    </div>
    
    <h1 id="formTitle">媒体记者信息收集</h1>
    
    <form id="contactForm">
        <div class="form-group"> <label for="name" id="nameLabel">姓名</label> <input type="text" id="name" name="name" required> </div>
        <div class="form-group"> <label for="email" id="emailLabel">电子邮箱</label> <input type="email" id="email" name="email" required> </div>
        <div class="form-group"> <label for="phone" id="phoneLabel">电话号码</label> <input type="tel" id="phone" name="phone"> </div>
        <div class="form-group"> <label for="media" id="mediaLabel">所属媒体机构</label> <input type="text" id="media" name="media" required> </div>
        <div class="form-group"> <label for="country" id="countryLabel">国家/地区</label> <input type="text" id="country" name="country" required> </div>
        <div class="form-group"> <label for="interests" id="interestsLabel">感兴趣的报道领域</label> <textarea id="interests" name="interests" rows="3"></textarea> </div>
        <button type="submit" id="submitBtn">提交信息</button>
    </form>
    
    <div class="success-message" id="successMessage">
        <p id="thankYouMessage">感谢您提交信息！我们将尽快与您联系。</p>
    </div>
    
    <script>
        // ==================== 修改区域 START ====================
        // 请将下面的网址替换为你从Google Apps Script部署后得到的Web应用网址
        const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwNCZUg5wtiWdlrd0AqnJgJtEo9YdtVPmqxhvITsWmNDwaSO4Qc0NXE-YHIyf-8HFIr/exec"; 
        // ==================== 修改区域 END ======================

        const translations = {
            cn: { formTitle: "媒体记者信息收集", nameLabel: "姓名", emailLabel: "电子邮箱", phoneLabel: "电话号码", mediaLabel: "所属媒体机构", countryLabel: "国家/地区", interestsLabel: "感兴趣的报道领域", submitBtn: "提交信息", thankYouMessage: "感谢您提交信息！我们将尽快与您联系。" },
            en: { formTitle: "Media Reporter Information Collection", nameLabel: "Name", emailLabel: "Email", phoneLabel: "Phone Number", mediaLabel: "Media Organization", countryLabel: "Country/Region", interestsLabel: "Areas of Interest", submitBtn: "Submit Information", thankYouMessage: "Thank you for submitting your information! We will contact you soon." }
        };
        
        function changeLanguage(lang) {
            Object.keys(translations[lang]).forEach(key => {
                const element = document.getElementById(key);
                if (element) element.textContent = translations[lang][key];
            });
        }
        
        document.getElementById("contactForm").addEventListener("submit", function(event) {
            event.preventDefault();
            
            const submitBtn = document.getElementById("submitBtn");
            submitBtn.disabled = true;
            submitBtn.textContent = "正在提交...";

            const formData = {
                name: document.getElementById("name").value,
                email: document.getElementById("email").value,
                phone: document.getElementById("phone").value,
                media: document.getElementById("media").value,
                country: document.getElementById("country").value,
                interests: document.getElementById("interests").value,
            };
            
            // ==================== 修改区域 START ====================
            // 将数据发送到Google Script
            fetch(SCRIPT_URL, {
                method: 'POST',
                mode: 'no-cors', //  CORS mode is not strictly necessary but good practice
                cache: 'no-cache',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(formData)
            })
            .then(response => {
                // 显示成功消息
                document.getElementById("successMessage").style.display = "block";
                document.getElementById("contactForm").reset();
                
                setTimeout(function() {
                    document.getElementById("successMessage").style.display = "none";
                }, 3000);
            })
            .catch(error => {
                console.error('Error:', error);
                alert("提交失败，请稍后重试。");
            })
            .finally(() => {
                 // 无论成功与否，都恢复按钮状态
                submitBtn.disabled = false;
                // 根据当前语言重置按钮文本
                const currentLang = document.getElementById("cn-btn").textContent === "中文" ? 'cn' : 'en';
                submitBtn.textContent = translations[currentLang].submitBtn;
            });
            // ==================== 修改区域 END ======================
        });
    </script>
</body>
</html>